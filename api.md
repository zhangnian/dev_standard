# API设计通用规范



#### API域名

统一域名：https://api.xxx.com

- 开发环境：请修改本地hosts文件，将api.xxx.com指向开发服务器的IP
- 正式环境：不用修改本地hosts文件



#### 通用规范

前后端通过HTTP API方式进行通讯，上线后升级为HTTPS。
所有接口的请求访问使用GET、POST，其含义如下：

- GET：查询类接口，幂等，不会修改后台数据
- POST：添加、修改、删除类接口，会修改后台数据



通过HTTP标准状态码表示接口状态，比如：

- 200：响应成功（注意：这里的响应成功只是表示网络层面请求成功，不代表业务处理成功，业务处理是否成功需要判断响应体中的code字段）
- 401：用户认证失败
- 403：无权限
- 404：API接口不存在
- 500：服务器内部错误



#### 请求规范

需要进行用户认证的接口需要在请求头中传入下列两个字段，服务端会通过这两个字段进行用户验证：

- X-UID：用户唯一ID，由注册、登陆接口返回
- X-TOKEN：用户Token，由注册、登陆接口返回



##### 请求的参数传递：

-  GET请求的参数放在url后面，以query string形式传递，如：
  /frontend/user/list?page=1&page_size=20 
-  POST请求的参数放在请求body中，以JSON形式传递，如: 

```json
{
  "telephone": "18600000001",
  "password": "123456"
}
```



#### 响应规范

所有API的响应由三个字段构成，分别是：code、msg、data，如下所示：

```json
{
  "code": 0,
  "data": {},
  "msg": ""
}
```

各字段表示的含义为：

- code：0代表成功，非0代表失败
- msg：错误描述，前端可以直接展示，非0才会有值
- data：包含具体的业务数据

示例

- 用户登录成功后的响应：

```json
{
  "code": 0,
  "data": {
    "created_at": 1604932298,
    "id": 1,
    "role_id": 1,
    "telephone": "18600000001",
    "token": "f62463a5a7ddaa5c5e78add4532bb174",
    "updated_at": 1604932300
  },
  "msg": ""
}
```



- 用户登录失败后的响应：

```json
{
  "code": 1,
  "data": null,
  "msg": "用户名或密码错误"
}
```